   1              		.syntax unified
   2              		.cpu cortex-m4
   3              		.eabi_attribute 27, 3
   4              		.fpu fpv4-sp-d16
   5              		.eabi_attribute 20, 1
   6              		.eabi_attribute 21, 1
   7              		.eabi_attribute 23, 3
   8              		.eabi_attribute 24, 1
   9              		.eabi_attribute 25, 1
  10              		.eabi_attribute 26, 1
  11              		.eabi_attribute 30, 6
  12              		.eabi_attribute 34, 1
  13              		.eabi_attribute 18, 4
  14              		.thumb
  15              		.file	"drv_gps.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.comm	mtk19ProcessDataState,1,1
  20              		.comm	nmeaProcessDataState,1,1
  21              		.comm	ubloxProcessDataState,1,1
  22              		.comm	rx2Buffer,2048,4
  23              		.global	rx2DMAPos
  24              		.bss
  25              		.align	2
  28              	rx2DMAPos:
  29 0000 00000000 		.space	4
  30              		.comm	tx2Buffer,2048,4
  31              		.global	tx2BufferTail
  32              		.align	1
  35              	tx2BufferTail:
  36 0004 0000     		.space	2
  37              		.global	tx2BufferHead
  38              		.align	1
  41              	tx2BufferHead:
  42 0006 0000     		.space	2
  43              		.text
  44              		.align	2
  45              		.thumb
  46              		.thumb_func
  48              	uart2TxDMA:
  49              	.LFB111:
  50              		.file 1 "../src/drv/drv_gps.c"
   1:../src/drv/drv_gps.c **** /*
   2:../src/drv/drv_gps.c ****   December 2012
   3:../src/drv/drv_gps.c **** 
   4:../src/drv/drv_gps.c ****   aq32Plus_F3 Rev -
   5:../src/drv/drv_gps.c **** 
   6:../src/drv/drv_gps.c ****   Copyright (c) 2012 John Ihlein.  All rights reserved.
   7:../src/drv/drv_gps.c **** 
   8:../src/drv/drv_gps.c ****   Open Source STM32 Based Multicopter Controller Software
   9:../src/drv/drv_gps.c **** 
  10:../src/drv/drv_gps.c ****   Includes code and/or ideas from:
  11:../src/drv/drv_gps.c **** 
  12:../src/drv/drv_gps.c ****   1)AeroQuad
  13:../src/drv/drv_gps.c ****   2)BaseFlight
  14:../src/drv/drv_gps.c ****   3)CH Robotics
  15:../src/drv/drv_gps.c ****   4)MultiWii
  16:../src/drv/drv_gps.c ****   5)S.O.H. Madgwick
  17:../src/drv/drv_gps.c ****   6)UAVX
  18:../src/drv/drv_gps.c ****   7)STM DiscoveryF3 demonstration software
  19:../src/drv/drv_gps.c **** 
  20:../src/drv/drv_gps.c ****   Designed to run on the DiscoveryF3 board
  21:../src/drv/drv_gps.c **** 
  22:../src/drv/drv_gps.c ****   This program is free software: you can redistribute it and/or modify
  23:../src/drv/drv_gps.c ****   it under the terms of the GNU General Public License as published by
  24:../src/drv/drv_gps.c ****   the Free Software Foundation, either version 3 of the License, or
  25:../src/drv/drv_gps.c ****   (at your option) any later version.
  26:../src/drv/drv_gps.c **** 
  27:../src/drv/drv_gps.c ****   This program is distributed in the hope that it will be useful,
  28:../src/drv/drv_gps.c ****   but WITHOUT ANY WARRANTY; without even the implied warranty of
  29:../src/drv/drv_gps.c ****   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
  30:../src/drv/drv_gps.c ****   GNU General Public License for more details.
  31:../src/drv/drv_gps.c **** 
  32:../src/drv/drv_gps.c ****   You should have received a copy of the GNU General Public License
  33:../src/drv/drv_gps.c ****   along with this program. If not, see <http://www.gnu.org/licenses/>.
  34:../src/drv/drv_gps.c **** */
  35:../src/drv/drv_gps.c **** 
  36:../src/drv/drv_gps.c **** ///////////////////////////////////////////////////////////////////////////////
  37:../src/drv/drv_gps.c **** 
  38:../src/drv/drv_gps.c **** #include "board.h"
  39:../src/drv/drv_gps.c **** 
  40:../src/drv/drv_gps.c **** ///////////////////////////////////////////////////////////////////////////////
  41:../src/drv/drv_gps.c **** 
  42:../src/drv/drv_gps.c **** /*
  43:../src/drv/drv_gps.c ****     DMA UART routines idea lifted from AutoQuad
  44:../src/drv/drv_gps.c ****     Copyright © 2011  Bill Nesbitt
  45:../src/drv/drv_gps.c **** */
  46:../src/drv/drv_gps.c **** 
  47:../src/drv/drv_gps.c **** ///////////////////////////////////////////////////////////////////////////////
  48:../src/drv/drv_gps.c **** // UART2 Defines and Variables
  49:../src/drv/drv_gps.c **** ///////////////////////////////////////////////////////////////////////////////
  50:../src/drv/drv_gps.c **** 
  51:../src/drv/drv_gps.c **** #define UART2_TX_PIN        GPIO_Pin_2
  52:../src/drv/drv_gps.c **** #define UART2_RX_PIN        GPIO_Pin_3
  53:../src/drv/drv_gps.c **** #define UART2_GPIO          GPIOA
  54:../src/drv/drv_gps.c **** #define UART2_TX_PINSOURCE  GPIO_PinSource2
  55:../src/drv/drv_gps.c **** #define UART2_RX_PINSOURCE  GPIO_PinSource3
  56:../src/drv/drv_gps.c **** 
  57:../src/drv/drv_gps.c **** #define UART2_BUFFER_SIZE    2048
  58:../src/drv/drv_gps.c **** 
  59:../src/drv/drv_gps.c **** // Receive buffer, circular DMA
  60:../src/drv/drv_gps.c **** volatile uint8_t rx2Buffer[UART2_BUFFER_SIZE];
  61:../src/drv/drv_gps.c **** uint32_t rx2DMAPos = 0;
  62:../src/drv/drv_gps.c **** 
  63:../src/drv/drv_gps.c **** volatile uint8_t tx2Buffer[UART2_BUFFER_SIZE];
  64:../src/drv/drv_gps.c **** uint16_t tx2BufferTail = 0;
  65:../src/drv/drv_gps.c **** uint16_t tx2BufferHead = 0;
  66:../src/drv/drv_gps.c **** 
  67:../src/drv/drv_gps.c **** ///////////////////////////////////////////////////////////////////////////////
  68:../src/drv/drv_gps.c **** // UART2 Transmit via DMA
  69:../src/drv/drv_gps.c **** ///////////////////////////////////////////////////////////////////////////////
  70:../src/drv/drv_gps.c **** 
  71:../src/drv/drv_gps.c **** static void uart2TxDMA(void)
  72:../src/drv/drv_gps.c **** {
  51              		.loc 1 72 0
  52              		.cfi_startproc
  53              		@ args = 0, pretend = 0, frame = 0
  54              		@ frame_needed = 0, uses_anonymous_args = 0
  55 0000 08B5     		push	{r3, lr}
  56              	.LCFI0:
  57              		.cfi_def_cfa_offset 8
  58              		.cfi_offset 14, -4
  59              		.cfi_offset 3, -8
  73:../src/drv/drv_gps.c ****     DMA1_Channel7->CMAR = (uint32_t)&tx2Buffer[tx2BufferTail];
  60              		.loc 1 73 0
  61 0002 4FF08003 		mov	r3, #128
  62 0006 C4F20203 		movt	r3, 16386
  63 000a 40F20002 		movw	r2, #:lower16:tx2BufferTail
  64 000e C0F20002 		movt	r2, #:upper16:tx2BufferTail
  65 0012 1288     		ldrh	r2, [r2, #0]
  66 0014 1146     		mov	r1, r2
  67 0016 40F20002 		movw	r2, #:lower16:tx2Buffer
  68 001a C0F20002 		movt	r2, #:upper16:tx2Buffer
  69 001e 8A18     		adds	r2, r1, r2
  70 0020 DA60     		str	r2, [r3, #12]
  74:../src/drv/drv_gps.c ****     if (tx2BufferHead > tx2BufferTail)
  71              		.loc 1 74 0
  72 0022 40F20003 		movw	r3, #:lower16:tx2BufferHead
  73 0026 C0F20003 		movt	r3, #:upper16:tx2BufferHead
  74 002a 1A88     		ldrh	r2, [r3, #0]
  75 002c 40F20003 		movw	r3, #:lower16:tx2BufferTail
  76 0030 C0F20003 		movt	r3, #:upper16:tx2BufferTail
  77 0034 1B88     		ldrh	r3, [r3, #0]
  78 0036 9A42     		cmp	r2, r3
  79 0038 1BD9     		bls	.L2
  75:../src/drv/drv_gps.c ****     {
  76:../src/drv/drv_gps.c ****     	DMA1_Channel7->CNDTR = tx2BufferHead - tx2BufferTail;
  80              		.loc 1 76 0
  81 003a 4FF08003 		mov	r3, #128
  82 003e C4F20203 		movt	r3, 16386
  83 0042 40F20002 		movw	r2, #:lower16:tx2BufferHead
  84 0046 C0F20002 		movt	r2, #:upper16:tx2BufferHead
  85 004a 1288     		ldrh	r2, [r2, #0]
  86 004c 1146     		mov	r1, r2
  87 004e 40F20002 		movw	r2, #:lower16:tx2BufferTail
  88 0052 C0F20002 		movt	r2, #:upper16:tx2BufferTail
  89 0056 1288     		ldrh	r2, [r2, #0]
  90 0058 8A1A     		subs	r2, r1, r2
  91 005a 5A60     		str	r2, [r3, #4]
  77:../src/drv/drv_gps.c **** 	    tx2BufferTail = tx2BufferHead;
  92              		.loc 1 77 0
  93 005c 40F20003 		movw	r3, #:lower16:tx2BufferHead
  94 0060 C0F20003 		movt	r3, #:upper16:tx2BufferHead
  95 0064 1A88     		ldrh	r2, [r3, #0]
  96 0066 40F20003 		movw	r3, #:lower16:tx2BufferTail
  97 006a C0F20003 		movt	r3, #:upper16:tx2BufferTail
  98 006e 1A80     		strh	r2, [r3, #0]	@ movhi
  99 0070 12E0     		b	.L3
 100              	.L2:
  78:../src/drv/drv_gps.c ****     }
  79:../src/drv/drv_gps.c ****     else
  80:../src/drv/drv_gps.c ****     {
  81:../src/drv/drv_gps.c ****     	DMA1_Channel7->CNDTR = UART2_BUFFER_SIZE - tx2BufferTail;
 101              		.loc 1 81 0
 102 0072 4FF08003 		mov	r3, #128
 103 0076 C4F20203 		movt	r3, 16386
 104 007a 40F20002 		movw	r2, #:lower16:tx2BufferTail
 105 007e C0F20002 		movt	r2, #:upper16:tx2BufferTail
 106 0082 1288     		ldrh	r2, [r2, #0]
 107 0084 C2F50062 		rsb	r2, r2, #2048
 108 0088 5A60     		str	r2, [r3, #4]
  82:../src/drv/drv_gps.c **** 	    tx2BufferTail = 0;
 109              		.loc 1 82 0
 110 008a 40F20003 		movw	r3, #:lower16:tx2BufferTail
 111 008e C0F20003 		movt	r3, #:upper16:tx2BufferTail
 112 0092 4FF00002 		mov	r2, #0
 113 0096 1A80     		strh	r2, [r3, #0]	@ movhi
 114              	.L3:
  83:../src/drv/drv_gps.c ****     }
  84:../src/drv/drv_gps.c **** 
  85:../src/drv/drv_gps.c ****     DMA_Cmd(DMA1_Channel7, ENABLE);
 115              		.loc 1 85 0
 116 0098 4FF08000 		mov	r0, #128
 117 009c C4F20200 		movt	r0, 16386
 118 00a0 4FF00101 		mov	r1, #1
 119 00a4 FFF7FEFF 		bl	DMA_Cmd
  86:../src/drv/drv_gps.c **** }
 120              		.loc 1 86 0
 121 00a8 08BD     		pop	{r3, pc}
 122              		.cfi_endproc
 123              	.LFE111:
 125 00aa 00BF     		.align	2
 126              		.global	DMA1_Channel7_IRQHandler
 127              		.thumb
 128              		.thumb_func
 130              	DMA1_Channel7_IRQHandler:
 131              	.LFB112:
  87:../src/drv/drv_gps.c **** 
  88:../src/drv/drv_gps.c **** ///////////////////////////////////////////////////////////////////////////////
  89:../src/drv/drv_gps.c **** // UART2 TX Complete Interrupt Handler
  90:../src/drv/drv_gps.c **** ///////////////////////////////////////////////////////////////////////////////
  91:../src/drv/drv_gps.c **** 
  92:../src/drv/drv_gps.c **** void DMA1_Channel7_IRQHandler(void)
  93:../src/drv/drv_gps.c **** {
 132              		.loc 1 93 0
 133              		.cfi_startproc
 134              		@ args = 0, pretend = 0, frame = 0
 135              		@ frame_needed = 0, uses_anonymous_args = 0
 136 00ac 08B5     		push	{r3, lr}
 137              	.LCFI1:
 138              		.cfi_def_cfa_offset 8
 139              		.cfi_offset 14, -4
 140              		.cfi_offset 3, -8
  94:../src/drv/drv_gps.c **** 	DMA_ClearITPendingBit(DMA1_IT_TC7);
 141              		.loc 1 94 0
 142 00ae 4FF00070 		mov	r0, #33554432
 143 00b2 FFF7FEFF 		bl	DMA_ClearITPendingBit
  95:../src/drv/drv_gps.c ****     DMA_Cmd(DMA1_Channel7, DISABLE);
 144              		.loc 1 95 0
 145 00b6 4FF08000 		mov	r0, #128
 146 00ba C4F20200 		movt	r0, 16386
 147 00be 4FF00001 		mov	r1, #0
 148 00c2 FFF7FEFF 		bl	DMA_Cmd
  96:../src/drv/drv_gps.c **** 
  97:../src/drv/drv_gps.c ****     if (tx2BufferHead != tx2BufferTail)
 149              		.loc 1 97 0
 150 00c6 40F20003 		movw	r3, #:lower16:tx2BufferHead
 151 00ca C0F20003 		movt	r3, #:upper16:tx2BufferHead
 152 00ce 1A88     		ldrh	r2, [r3, #0]
 153 00d0 40F20003 		movw	r3, #:lower16:tx2BufferTail
 154 00d4 C0F20003 		movt	r3, #:upper16:tx2BufferTail
 155 00d8 1B88     		ldrh	r3, [r3, #0]
 156 00da 9A42     		cmp	r2, r3
 157 00dc 01D0     		beq	.L4
  98:../src/drv/drv_gps.c **** 	    uart2TxDMA();
 158              		.loc 1 98 0
 159 00de FFF78FFF 		bl	uart2TxDMA
 160              	.L4:
  99:../src/drv/drv_gps.c **** }
 161              		.loc 1 99 0
 162 00e2 08BD     		pop	{r3, pc}
 163              		.cfi_endproc
 164              	.LFE112:
 166              		.align	2
 167              		.global	gpsInit
 168              		.thumb
 169              		.thumb_func
 171              	gpsInit:
 172              	.LFB113:
 100:../src/drv/drv_gps.c **** 
 101:../src/drv/drv_gps.c **** ///////////////////////////////////////////////////////////////////////////////
 102:../src/drv/drv_gps.c **** // GPS Initialization
 103:../src/drv/drv_gps.c **** ///////////////////////////////////////////////////////////////////////////////
 104:../src/drv/drv_gps.c **** 
 105:../src/drv/drv_gps.c **** void gpsInit(void)
 106:../src/drv/drv_gps.c **** {
 173              		.loc 1 106 0
 174              		.cfi_startproc
 175              		@ args = 0, pretend = 0, frame = 80
 176              		@ frame_needed = 0, uses_anonymous_args = 0
 177 00e4 00B5     		push	{lr}
 178              	.LCFI2:
 179              		.cfi_def_cfa_offset 4
 180              		.cfi_offset 14, -4
 181 00e6 95B0     		sub	sp, sp, #84
 182              	.LCFI3:
 183              		.cfi_def_cfa_offset 88
 107:../src/drv/drv_gps.c ****     GPIO_InitTypeDef  GPIO_InitStructure;
 108:../src/drv/drv_gps.c ****     USART_InitTypeDef USART_InitStructure;
 109:../src/drv/drv_gps.c ****     DMA_InitTypeDef   DMA_InitStructure;
 110:../src/drv/drv_gps.c ****     NVIC_InitTypeDef  NVIC_InitStructure;
 111:../src/drv/drv_gps.c **** 
 112:../src/drv/drv_gps.c ****     RCC_AHBPeriphClockCmd(RCC_AHBPeriph_GPIOA,    ENABLE);
 184              		.loc 1 112 0
 185 00e8 4FF40030 		mov	r0, #131072
 186 00ec 4FF00101 		mov	r1, #1
 187 00f0 FFF7FEFF 		bl	RCC_AHBPeriphClockCmd
 113:../src/drv/drv_gps.c ****     RCC_AHBPeriphClockCmd(RCC_AHBPeriph_DMA1,     ENABLE);
 188              		.loc 1 113 0
 189 00f4 4FF00100 		mov	r0, #1
 190 00f8 4FF00101 		mov	r1, #1
 191 00fc FFF7FEFF 		bl	RCC_AHBPeriphClockCmd
 114:../src/drv/drv_gps.c ****     RCC_APB1PeriphClockCmd(RCC_APB1Periph_USART2, ENABLE);
 192              		.loc 1 114 0
 193 0100 4FF40030 		mov	r0, #131072
 194 0104 4FF00101 		mov	r1, #1
 195 0108 FFF7FEFF 		bl	RCC_APB1PeriphClockCmd
 115:../src/drv/drv_gps.c **** 
 116:../src/drv/drv_gps.c ****     GPIO_InitStructure.GPIO_Pin   = UART2_TX_PIN | UART2_RX_PIN;
 196              		.loc 1 116 0
 197 010c 4FF00C03 		mov	r3, #12
 198 0110 1293     		str	r3, [sp, #72]
 117:../src/drv/drv_gps.c ****     GPIO_InitStructure.GPIO_Mode  = GPIO_Mode_AF;
 199              		.loc 1 117 0
 200 0112 4FF00203 		mov	r3, #2
 201 0116 8DF84C30 		strb	r3, [sp, #76]
 118:../src/drv/drv_gps.c ****     GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;
 202              		.loc 1 118 0
 203 011a 4FF00303 		mov	r3, #3
 204 011e 8DF84D30 		strb	r3, [sp, #77]
 119:../src/drv/drv_gps.c ****     GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;
 205              		.loc 1 119 0
 206 0122 4FF00003 		mov	r3, #0
 207 0126 8DF84E30 		strb	r3, [sp, #78]
 120:../src/drv/drv_gps.c ****     GPIO_InitStructure.GPIO_PuPd  = GPIO_PuPd_UP;
 208              		.loc 1 120 0
 209 012a 4FF00103 		mov	r3, #1
 210 012e 8DF84F30 		strb	r3, [sp, #79]
 121:../src/drv/drv_gps.c **** 
 122:../src/drv/drv_gps.c ****     GPIO_PinAFConfig(UART2_GPIO, UART2_TX_PINSOURCE, GPIO_AF_7);
 211              		.loc 1 122 0
 212 0132 4FF09040 		mov	r0, #1207959552
 213 0136 4FF00201 		mov	r1, #2
 214 013a 4FF00702 		mov	r2, #7
 215 013e FFF7FEFF 		bl	GPIO_PinAFConfig
 123:../src/drv/drv_gps.c ****     GPIO_PinAFConfig(UART2_GPIO, UART2_RX_PINSOURCE, GPIO_AF_7);
 216              		.loc 1 123 0
 217 0142 4FF09040 		mov	r0, #1207959552
 218 0146 4FF00301 		mov	r1, #3
 219 014a 4FF00702 		mov	r2, #7
 220 014e FFF7FEFF 		bl	GPIO_PinAFConfig
 124:../src/drv/drv_gps.c **** 
 125:../src/drv/drv_gps.c ****     GPIO_Init(UART2_GPIO, &GPIO_InitStructure);
 221              		.loc 1 125 0
 222 0152 4FF09040 		mov	r0, #1207959552
 223 0156 12AB     		add	r3, sp, #72
 224 0158 1946     		mov	r1, r3
 225 015a FFF7FEFF 		bl	GPIO_Init
 126:../src/drv/drv_gps.c **** 
 127:../src/drv/drv_gps.c ****     // DMA TX Interrupt
 128:../src/drv/drv_gps.c ****     NVIC_InitStructure.NVIC_IRQChannel                   = DMA1_Channel7_IRQn;
 226              		.loc 1 128 0
 227 015e 4FF01103 		mov	r3, #17
 228 0162 8DF80030 		strb	r3, [sp, #0]
 129:../src/drv/drv_gps.c ****     NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = 1;
 229              		.loc 1 129 0
 230 0166 4FF00103 		mov	r3, #1
 231 016a 8DF80130 		strb	r3, [sp, #1]
 130:../src/drv/drv_gps.c ****     NVIC_InitStructure.NVIC_IRQChannelSubPriority        = 0;
 232              		.loc 1 130 0
 233 016e 4FF00003 		mov	r3, #0
 234 0172 8DF80230 		strb	r3, [sp, #2]
 131:../src/drv/drv_gps.c ****     NVIC_InitStructure.NVIC_IRQChannelCmd                = ENABLE;
 235              		.loc 1 131 0
 236 0176 4FF00103 		mov	r3, #1
 237 017a 8DF80330 		strb	r3, [sp, #3]
 132:../src/drv/drv_gps.c **** 
 133:../src/drv/drv_gps.c ****     NVIC_Init(&NVIC_InitStructure);
 238              		.loc 1 133 0
 239 017e 6B46     		mov	r3, sp
 240 0180 1846     		mov	r0, r3
 241 0182 FFF7FEFF 		bl	NVIC_Init
 134:../src/drv/drv_gps.c **** 
 135:../src/drv/drv_gps.c ****     USART_InitStructure.USART_BaudRate            = 115200;
 242              		.loc 1 135 0
 243 0186 4FF4E133 		mov	r3, #115200
 244 018a 0C93     		str	r3, [sp, #48]
 136:../src/drv/drv_gps.c ****     USART_InitStructure.USART_WordLength          = USART_WordLength_8b;
 245              		.loc 1 136 0
 246 018c 4FF00003 		mov	r3, #0
 247 0190 0D93     		str	r3, [sp, #52]
 137:../src/drv/drv_gps.c ****     USART_InitStructure.USART_StopBits            = USART_StopBits_1;
 248              		.loc 1 137 0
 249 0192 4FF00003 		mov	r3, #0
 250 0196 0E93     		str	r3, [sp, #56]
 138:../src/drv/drv_gps.c ****     USART_InitStructure.USART_Parity              = USART_Parity_No;
 251              		.loc 1 138 0
 252 0198 4FF00003 		mov	r3, #0
 253 019c 0F93     		str	r3, [sp, #60]
 139:../src/drv/drv_gps.c ****     USART_InitStructure.USART_Mode                = USART_Mode_Rx | USART_Mode_Tx;
 254              		.loc 1 139 0
 255 019e 4FF00C03 		mov	r3, #12
 256 01a2 1093     		str	r3, [sp, #64]
 140:../src/drv/drv_gps.c ****     USART_InitStructure.USART_HardwareFlowControl = USART_HardwareFlowControl_None;
 257              		.loc 1 140 0
 258 01a4 4FF00003 		mov	r3, #0
 259 01a8 1193     		str	r3, [sp, #68]
 141:../src/drv/drv_gps.c **** 
 142:../src/drv/drv_gps.c ****     USART_Init(USART2, &USART_InitStructure);
 260              		.loc 1 142 0
 261 01aa 4FF48840 		mov	r0, #17408
 262 01ae C4F20000 		movt	r0, 16384
 263 01b2 0CAB     		add	r3, sp, #48
 264 01b4 1946     		mov	r1, r3
 265 01b6 FFF7FEFF 		bl	USART_Init
 143:../src/drv/drv_gps.c **** 
 144:../src/drv/drv_gps.c ****     // Receive DMA into a circular buffer
 145:../src/drv/drv_gps.c **** 
 146:../src/drv/drv_gps.c ****     DMA_DeInit(DMA1_Channel6);
 266              		.loc 1 146 0
 267 01ba 4FF06C00 		mov	r0, #108
 268 01be C4F20200 		movt	r0, 16386
 269 01c2 FFF7FEFF 		bl	DMA_DeInit
 147:../src/drv/drv_gps.c **** 
 148:../src/drv/drv_gps.c ****     DMA_InitStructure.DMA_BufferSize         = UART2_BUFFER_SIZE;
 270              		.loc 1 148 0
 271 01c6 4FF40063 		mov	r3, #2048
 272 01ca ADF81030 		strh	r3, [sp, #16]	@ movhi
 149:../src/drv/drv_gps.c ****     DMA_InitStructure.DMA_DIR                = DMA_DIR_PeripheralSRC;
 273              		.loc 1 149 0
 274 01ce 4FF00003 		mov	r3, #0
 275 01d2 0393     		str	r3, [sp, #12]
 150:../src/drv/drv_gps.c ****     DMA_InitStructure.DMA_M2M                = DMA_M2M_Disable;
 276              		.loc 1 150 0
 277 01d4 4FF00003 		mov	r3, #0
 278 01d8 0B93     		str	r3, [sp, #44]
 151:../src/drv/drv_gps.c ****     DMA_InitStructure.DMA_MemoryBaseAddr     = (uint32_t)rx2Buffer;
 279              		.loc 1 151 0
 280 01da 40F20003 		movw	r3, #:lower16:rx2Buffer
 281 01de C0F20003 		movt	r3, #:upper16:rx2Buffer
 282 01e2 0293     		str	r3, [sp, #8]
 152:../src/drv/drv_gps.c ****     DMA_InitStructure.DMA_MemoryDataSize     = DMA_MemoryDataSize_Byte;
 283              		.loc 1 152 0
 284 01e4 4FF00003 		mov	r3, #0
 285 01e8 0893     		str	r3, [sp, #32]
 153:../src/drv/drv_gps.c ****     DMA_InitStructure.DMA_MemoryInc          = DMA_MemoryInc_Enable;
 286              		.loc 1 153 0
 287 01ea 4FF08003 		mov	r3, #128
 288 01ee 0693     		str	r3, [sp, #24]
 154:../src/drv/drv_gps.c ****     DMA_InitStructure.DMA_Mode               = DMA_Mode_Circular;
 289              		.loc 1 154 0
 290 01f0 4FF02003 		mov	r3, #32
 291 01f4 0993     		str	r3, [sp, #36]
 155:../src/drv/drv_gps.c ****     DMA_InitStructure.DMA_PeripheralBaseAddr = (uint32_t)&USART2->RDR;
 292              		.loc 1 155 0
 293 01f6 44F22443 		movw	r3, #17444
 294 01fa C4F20003 		movt	r3, 16384
 295 01fe 0193     		str	r3, [sp, #4]
 156:../src/drv/drv_gps.c ****     DMA_InitStructure.DMA_PeripheralDataSize = DMA_PeripheralDataSize_Byte;
 296              		.loc 1 156 0
 297 0200 4FF00003 		mov	r3, #0
 298 0204 0793     		str	r3, [sp, #28]
 157:../src/drv/drv_gps.c ****     DMA_InitStructure.DMA_PeripheralInc      = DMA_PeripheralInc_Disable;
 299              		.loc 1 157 0
 300 0206 4FF00003 		mov	r3, #0
 301 020a 0593     		str	r3, [sp, #20]
 158:../src/drv/drv_gps.c ****     DMA_InitStructure.DMA_Priority           = DMA_Priority_Medium;
 302              		.loc 1 158 0
 303 020c 4FF48053 		mov	r3, #4096
 304 0210 0A93     		str	r3, [sp, #40]
 159:../src/drv/drv_gps.c **** 
 160:../src/drv/drv_gps.c ****     DMA_Init(DMA1_Channel6, &DMA_InitStructure);
 305              		.loc 1 160 0
 306 0212 4FF06C00 		mov	r0, #108
 307 0216 C4F20200 		movt	r0, 16386
 308 021a 01AB     		add	r3, sp, #4
 309 021c 1946     		mov	r1, r3
 310 021e FFF7FEFF 		bl	DMA_Init
 161:../src/drv/drv_gps.c **** 
 162:../src/drv/drv_gps.c ****     DMA_Cmd(DMA1_Channel6, ENABLE);
 311              		.loc 1 162 0
 312 0222 4FF06C00 		mov	r0, #108
 313 0226 C4F20200 		movt	r0, 16386
 314 022a 4FF00101 		mov	r1, #1
 315 022e FFF7FEFF 		bl	DMA_Cmd
 163:../src/drv/drv_gps.c **** 
 164:../src/drv/drv_gps.c ****     USART_DMACmd(USART2, USART_DMAReq_Rx, ENABLE);
 316              		.loc 1 164 0
 317 0232 4FF48840 		mov	r0, #17408
 318 0236 C4F20000 		movt	r0, 16384
 319 023a 4FF04001 		mov	r1, #64
 320 023e 4FF00102 		mov	r2, #1
 321 0242 FFF7FEFF 		bl	USART_DMACmd
 165:../src/drv/drv_gps.c **** 
 166:../src/drv/drv_gps.c ****     rx2DMAPos = DMA_GetCurrDataCounter(DMA1_Channel6);
 322              		.loc 1 166 0
 323 0246 4FF06C00 		mov	r0, #108
 324 024a C4F20200 		movt	r0, 16386
 325 024e FFF7FEFF 		bl	DMA_GetCurrDataCounter
 326 0252 0346     		mov	r3, r0
 327 0254 1A46     		mov	r2, r3
 328 0256 40F20003 		movw	r3, #:lower16:rx2DMAPos
 329 025a C0F20003 		movt	r3, #:upper16:rx2DMAPos
 330 025e 1A60     		str	r2, [r3, #0]
 167:../src/drv/drv_gps.c **** 
 168:../src/drv/drv_gps.c ****     // Transmit DMA
 169:../src/drv/drv_gps.c ****     DMA_DeInit(DMA1_Channel7);
 331              		.loc 1 169 0
 332 0260 4FF08000 		mov	r0, #128
 333 0264 C4F20200 		movt	r0, 16386
 334 0268 FFF7FEFF 		bl	DMA_DeInit
 170:../src/drv/drv_gps.c **** 
 171:../src/drv/drv_gps.c ****     DMA_InitStructure.DMA_BufferSize         = UART2_BUFFER_SIZE;
 335              		.loc 1 171 0
 336 026c 4FF40063 		mov	r3, #2048
 337 0270 ADF81030 		strh	r3, [sp, #16]	@ movhi
 172:../src/drv/drv_gps.c ****     DMA_InitStructure.DMA_DIR                = DMA_DIR_PeripheralDST;
 338              		.loc 1 172 0
 339 0274 4FF01003 		mov	r3, #16
 340 0278 0393     		str	r3, [sp, #12]
 173:../src/drv/drv_gps.c ****     DMA_InitStructure.DMA_M2M                = DMA_M2M_Disable;
 341              		.loc 1 173 0
 342 027a 4FF00003 		mov	r3, #0
 343 027e 0B93     		str	r3, [sp, #44]
 174:../src/drv/drv_gps.c ****     DMA_InitStructure.DMA_MemoryBaseAddr     = (uint32_t)tx2Buffer;
 344              		.loc 1 174 0
 345 0280 40F20003 		movw	r3, #:lower16:tx2Buffer
 346 0284 C0F20003 		movt	r3, #:upper16:tx2Buffer
 347 0288 0293     		str	r3, [sp, #8]
 175:../src/drv/drv_gps.c ****     DMA_InitStructure.DMA_MemoryDataSize     = DMA_MemoryDataSize_Byte;
 348              		.loc 1 175 0
 349 028a 4FF00003 		mov	r3, #0
 350 028e 0893     		str	r3, [sp, #32]
 176:../src/drv/drv_gps.c ****     DMA_InitStructure.DMA_MemoryInc          = DMA_MemoryInc_Enable;
 351              		.loc 1 176 0
 352 0290 4FF08003 		mov	r3, #128
 353 0294 0693     		str	r3, [sp, #24]
 177:../src/drv/drv_gps.c ****     DMA_InitStructure.DMA_Mode               = DMA_Mode_Normal;
 354              		.loc 1 177 0
 355 0296 4FF00003 		mov	r3, #0
 356 029a 0993     		str	r3, [sp, #36]
 178:../src/drv/drv_gps.c ****     DMA_InitStructure.DMA_PeripheralBaseAddr = (uint32_t) &USART2->TDR;
 357              		.loc 1 178 0
 358 029c 44F22843 		movw	r3, #17448
 359 02a0 C4F20003 		movt	r3, 16384
 360 02a4 0193     		str	r3, [sp, #4]
 179:../src/drv/drv_gps.c ****     DMA_InitStructure.DMA_PeripheralDataSize = DMA_PeripheralDataSize_Byte;
 361              		.loc 1 179 0
 362 02a6 4FF00003 		mov	r3, #0
 363 02aa 0793     		str	r3, [sp, #28]
 180:../src/drv/drv_gps.c ****     DMA_InitStructure.DMA_PeripheralInc      = DMA_PeripheralInc_Disable;
 364              		.loc 1 180 0
 365 02ac 4FF00003 		mov	r3, #0
 366 02b0 0593     		str	r3, [sp, #20]
 181:../src/drv/drv_gps.c ****     DMA_InitStructure.DMA_Priority           = DMA_Priority_Medium;
 367              		.loc 1 181 0
 368 02b2 4FF48053 		mov	r3, #4096
 369 02b6 0A93     		str	r3, [sp, #40]
 182:../src/drv/drv_gps.c **** 
 183:../src/drv/drv_gps.c ****     DMA_Init(DMA1_Channel7, &DMA_InitStructure);
 370              		.loc 1 183 0
 371 02b8 4FF08000 		mov	r0, #128
 372 02bc C4F20200 		movt	r0, 16386
 373 02c0 01AB     		add	r3, sp, #4
 374 02c2 1946     		mov	r1, r3
 375 02c4 FFF7FEFF 		bl	DMA_Init
 184:../src/drv/drv_gps.c **** 
 185:../src/drv/drv_gps.c ****     DMA_ITConfig(DMA1_Channel7, DMA_IT_TC, ENABLE);
 376              		.loc 1 185 0
 377 02c8 4FF08000 		mov	r0, #128
 378 02cc C4F20200 		movt	r0, 16386
 379 02d0 4FF00201 		mov	r1, #2
 380 02d4 4FF00102 		mov	r2, #1
 381 02d8 FFF7FEFF 		bl	DMA_ITConfig
 186:../src/drv/drv_gps.c **** 
 187:../src/drv/drv_gps.c ****     DMA1_Channel7->CNDTR = 0;
 382              		.loc 1 187 0
 383 02dc 4FF08003 		mov	r3, #128
 384 02e0 C4F20203 		movt	r3, 16386
 385 02e4 4FF00002 		mov	r2, #0
 386 02e8 5A60     		str	r2, [r3, #4]
 188:../src/drv/drv_gps.c **** 
 189:../src/drv/drv_gps.c ****     USART_DMACmd(USART2, USART_DMAReq_Tx, ENABLE);
 387              		.loc 1 189 0
 388 02ea 4FF48840 		mov	r0, #17408
 389 02ee C4F20000 		movt	r0, 16384
 390 02f2 4FF08001 		mov	r1, #128
 391 02f6 4FF00102 		mov	r2, #1
 392 02fa FFF7FEFF 		bl	USART_DMACmd
 190:../src/drv/drv_gps.c **** 
 191:../src/drv/drv_gps.c ****     USART_Cmd(USART2, ENABLE);
 393              		.loc 1 191 0
 394 02fe 4FF48840 		mov	r0, #17408
 395 0302 C4F20000 		movt	r0, 16384
 396 0306 4FF00101 		mov	r1, #1
 397 030a FFF7FEFF 		bl	USART_Cmd
 192:../src/drv/drv_gps.c **** }
 398              		.loc 1 192 0
 399 030e 15B0     		add	sp, sp, #84
 400 0310 00BD     		pop	{pc}
 401              		.cfi_endproc
 402              	.LFE113:
 404 0312 00BF     		.align	2
 405              		.global	gpsAvailable
 406              		.thumb
 407              		.thumb_func
 409              	gpsAvailable:
 410              	.LFB114:
 193:../src/drv/drv_gps.c **** 
 194:../src/drv/drv_gps.c **** ///////////////////////////////////////////////////////////////////////////////
 195:../src/drv/drv_gps.c **** // GPS Available
 196:../src/drv/drv_gps.c **** ///////////////////////////////////////////////////////////////////////////////
 197:../src/drv/drv_gps.c **** 
 198:../src/drv/drv_gps.c **** uint16_t gpsAvailable(void)
 199:../src/drv/drv_gps.c **** {
 411              		.loc 1 199 0
 412              		.cfi_startproc
 413              		@ args = 0, pretend = 0, frame = 0
 414              		@ frame_needed = 0, uses_anonymous_args = 0
 415 0314 08B5     		push	{r3, lr}
 416              	.LCFI4:
 417              		.cfi_def_cfa_offset 8
 418              		.cfi_offset 14, -4
 419              		.cfi_offset 3, -8
 200:../src/drv/drv_gps.c ****     return (DMA_GetCurrDataCounter(DMA1_Channel6) != rx2DMAPos) ? true : false;
 420              		.loc 1 200 0
 421 0316 4FF06C00 		mov	r0, #108
 422 031a C4F20200 		movt	r0, 16386
 423 031e FFF7FEFF 		bl	DMA_GetCurrDataCounter
 424 0322 0346     		mov	r3, r0
 425 0324 1A46     		mov	r2, r3
 426 0326 40F20003 		movw	r3, #:lower16:rx2DMAPos
 427 032a C0F20003 		movt	r3, #:upper16:rx2DMAPos
 428 032e 1B68     		ldr	r3, [r3, #0]
 429 0330 9A42     		cmp	r2, r3
 430 0332 0CBF     		ite	eq
 431 0334 0023     		moveq	r3, #0
 432 0336 0123     		movne	r3, #1
 433 0338 9BB2     		uxth	r3, r3
 201:../src/drv/drv_gps.c **** }
 434              		.loc 1 201 0
 435 033a 1846     		mov	r0, r3
 436 033c 08BD     		pop	{r3, pc}
 437              		.cfi_endproc
 438              	.LFE114:
 440 033e 00BF     		.align	2
 441              		.global	gpsClearBuffer
 442              		.thumb
 443              		.thumb_func
 445              	gpsClearBuffer:
 446              	.LFB115:
 202:../src/drv/drv_gps.c **** 
 203:../src/drv/drv_gps.c **** ///////////////////////////////////////////////////////////////////////////////
 204:../src/drv/drv_gps.c **** // GPS Clear Buffer
 205:../src/drv/drv_gps.c **** ///////////////////////////////////////////////////////////////////////////////
 206:../src/drv/drv_gps.c **** 
 207:../src/drv/drv_gps.c **** void gpsClearBuffer(void)
 208:../src/drv/drv_gps.c **** {
 447              		.loc 1 208 0
 448              		.cfi_startproc
 449              		@ args = 0, pretend = 0, frame = 0
 450              		@ frame_needed = 0, uses_anonymous_args = 0
 451 0340 08B5     		push	{r3, lr}
 452              	.LCFI5:
 453              		.cfi_def_cfa_offset 8
 454              		.cfi_offset 14, -4
 455              		.cfi_offset 3, -8
 209:../src/drv/drv_gps.c ****     rx2DMAPos = DMA_GetCurrDataCounter(DMA1_Channel6);
 456              		.loc 1 209 0
 457 0342 4FF06C00 		mov	r0, #108
 458 0346 C4F20200 		movt	r0, 16386
 459 034a FFF7FEFF 		bl	DMA_GetCurrDataCounter
 460 034e 0346     		mov	r3, r0
 461 0350 1A46     		mov	r2, r3
 462 0352 40F20003 		movw	r3, #:lower16:rx2DMAPos
 463 0356 C0F20003 		movt	r3, #:upper16:rx2DMAPos
 464 035a 1A60     		str	r2, [r3, #0]
 210:../src/drv/drv_gps.c **** }
 465              		.loc 1 210 0
 466 035c 08BD     		pop	{r3, pc}
 467              		.cfi_endproc
 468              	.LFE115:
 470 035e 00BF     		.align	2
 471              		.global	gpsNumCharsAvailable
 472              		.thumb
 473              		.thumb_func
 475              	gpsNumCharsAvailable:
 476              	.LFB116:
 211:../src/drv/drv_gps.c **** 
 212:../src/drv/drv_gps.c **** ///////////////////////////////////////////////////////////////////////////////
 213:../src/drv/drv_gps.c **** // GPS Number of Characters Available
 214:../src/drv/drv_gps.c **** ///////////////////////////////////////////////////////////////////////////////
 215:../src/drv/drv_gps.c **** 
 216:../src/drv/drv_gps.c **** uint16_t gpsNumCharsAvailable(void)
 217:../src/drv/drv_gps.c **** {
 477              		.loc 1 217 0
 478              		.cfi_startproc
 479              		@ args = 0, pretend = 0, frame = 8
 480              		@ frame_needed = 0, uses_anonymous_args = 0
 481 0360 10B5     		push	{r4, lr}
 482              	.LCFI6:
 483              		.cfi_def_cfa_offset 8
 484              		.cfi_offset 14, -4
 485              		.cfi_offset 4, -8
 486 0362 82B0     		sub	sp, sp, #8
 487              	.LCFI7:
 488              		.cfi_def_cfa_offset 16
 218:../src/drv/drv_gps.c **** 	int32_t number;
 219:../src/drv/drv_gps.c **** 
 220:../src/drv/drv_gps.c **** 	number = rx2DMAPos - DMA_GetCurrDataCounter(DMA1_Channel6);
 489              		.loc 1 220 0
 490 0364 40F20003 		movw	r3, #:lower16:rx2DMAPos
 491 0368 C0F20003 		movt	r3, #:upper16:rx2DMAPos
 492 036c 1C68     		ldr	r4, [r3, #0]
 493 036e 4FF06C00 		mov	r0, #108
 494 0372 C4F20200 		movt	r0, 16386
 495 0376 FFF7FEFF 		bl	DMA_GetCurrDataCounter
 496 037a 0346     		mov	r3, r0
 497 037c E31A     		subs	r3, r4, r3
 498 037e 0193     		str	r3, [sp, #4]
 221:../src/drv/drv_gps.c **** 
 222:../src/drv/drv_gps.c **** 	if (number >= 0)
 499              		.loc 1 222 0
 500 0380 019B     		ldr	r3, [sp, #4]
 501 0382 002B     		cmp	r3, #0
 502 0384 02DB     		blt	.L10
 223:../src/drv/drv_gps.c **** 	    return (uint16_t)number;
 503              		.loc 1 223 0
 504 0386 019B     		ldr	r3, [sp, #4]
 505 0388 9BB2     		uxth	r3, r3
 506 038a 04E0     		b	.L11
 507              	.L10:
 224:../src/drv/drv_gps.c **** 	else
 225:../src/drv/drv_gps.c **** 	    return (uint16_t)(UART2_BUFFER_SIZE + number);
 508              		.loc 1 225 0
 509 038c 019B     		ldr	r3, [sp, #4]
 510 038e 9BB2     		uxth	r3, r3
 511 0390 03F50063 		add	r3, r3, #2048
 512 0394 9BB2     		uxth	r3, r3
 513              	.L11:
 226:../src/drv/drv_gps.c **** }
 514              		.loc 1 226 0
 515 0396 1846     		mov	r0, r3
 516 0398 02B0     		add	sp, sp, #8
 517 039a 10BD     		pop	{r4, pc}
 518              		.cfi_endproc
 519              	.LFE116:
 521              		.align	2
 522              		.global	gpsRead
 523              		.thumb
 524              		.thumb_func
 526              	gpsRead:
 527              	.LFB117:
 227:../src/drv/drv_gps.c **** 
 228:../src/drv/drv_gps.c **** ///////////////////////////////////////////////////////////////////////////////
 229:../src/drv/drv_gps.c **** // GPS Read
 230:../src/drv/drv_gps.c **** ///////////////////////////////////////////////////////////////////////////////
 231:../src/drv/drv_gps.c **** 
 232:../src/drv/drv_gps.c **** uint8_t gpsRead(void)
 233:../src/drv/drv_gps.c **** {
 528              		.loc 1 233 0
 529              		.cfi_startproc
 530              		@ args = 0, pretend = 0, frame = 8
 531              		@ frame_needed = 0, uses_anonymous_args = 0
 532              		@ link register save eliminated.
 533 039c 82B0     		sub	sp, sp, #8
 534              	.LCFI8:
 535              		.cfi_def_cfa_offset 8
 234:../src/drv/drv_gps.c ****     uint8_t ch;
 235:../src/drv/drv_gps.c **** 
 236:../src/drv/drv_gps.c ****     ch = rx2Buffer[UART2_BUFFER_SIZE - rx2DMAPos];
 536              		.loc 1 236 0
 537 039e 40F20003 		movw	r3, #:lower16:rx2DMAPos
 538 03a2 C0F20003 		movt	r3, #:upper16:rx2DMAPos
 539 03a6 1B68     		ldr	r3, [r3, #0]
 540 03a8 C3F50062 		rsb	r2, r3, #2048
 541 03ac 40F20003 		movw	r3, #:lower16:rx2Buffer
 542 03b0 C0F20003 		movt	r3, #:upper16:rx2Buffer
 543 03b4 9B5C     		ldrb	r3, [r3, r2]
 544 03b6 8DF80730 		strb	r3, [sp, #7]
 237:../src/drv/drv_gps.c ****     // go back around the buffer
 238:../src/drv/drv_gps.c ****     if (--rx2DMAPos == 0)
 545              		.loc 1 238 0
 546 03ba 40F20003 		movw	r3, #:lower16:rx2DMAPos
 547 03be C0F20003 		movt	r3, #:upper16:rx2DMAPos
 548 03c2 1B68     		ldr	r3, [r3, #0]
 549 03c4 03F1FF32 		add	r2, r3, #-1
 550 03c8 40F20003 		movw	r3, #:lower16:rx2DMAPos
 551 03cc C0F20003 		movt	r3, #:upper16:rx2DMAPos
 552 03d0 1A60     		str	r2, [r3, #0]
 553 03d2 40F20003 		movw	r3, #:lower16:rx2DMAPos
 554 03d6 C0F20003 		movt	r3, #:upper16:rx2DMAPos
 555 03da 1B68     		ldr	r3, [r3, #0]
 556 03dc 002B     		cmp	r3, #0
 557 03de 06D1     		bne	.L13
 239:../src/drv/drv_gps.c **** 	    rx2DMAPos = UART2_BUFFER_SIZE;
 558              		.loc 1 239 0
 559 03e0 40F20003 		movw	r3, #:lower16:rx2DMAPos
 560 03e4 C0F20003 		movt	r3, #:upper16:rx2DMAPos
 561 03e8 4FF40062 		mov	r2, #2048
 562 03ec 1A60     		str	r2, [r3, #0]
 563              	.L13:
 240:../src/drv/drv_gps.c **** 
 241:../src/drv/drv_gps.c ****     return ch;
 564              		.loc 1 241 0
 565 03ee 9DF80730 		ldrb	r3, [sp, #7]	@ zero_extendqisi2
 242:../src/drv/drv_gps.c **** }
 566              		.loc 1 242 0
 567 03f2 1846     		mov	r0, r3
 568 03f4 02B0     		add	sp, sp, #8
 569 03f6 7047     		bx	lr
 570              		.cfi_endproc
 571              	.LFE117:
 573              		.align	2
 574              		.global	gpsReadPoll
 575              		.thumb
 576              		.thumb_func
 578              	gpsReadPoll:
 579              	.LFB118:
 243:../src/drv/drv_gps.c **** 
 244:../src/drv/drv_gps.c **** ///////////////////////////////////////////////////////////////////////////////
 245:../src/drv/drv_gps.c **** // GPS Read Poll
 246:../src/drv/drv_gps.c **** ///////////////////////////////////////////////////////////////////////////////
 247:../src/drv/drv_gps.c **** 
 248:../src/drv/drv_gps.c **** uint8_t gpsReadPoll(void)
 249:../src/drv/drv_gps.c **** {
 580              		.loc 1 249 0
 581              		.cfi_startproc
 582              		@ args = 0, pretend = 0, frame = 0
 583              		@ frame_needed = 0, uses_anonymous_args = 0
 584 03f8 08B5     		push	{r3, lr}
 585              	.LCFI9:
 586              		.cfi_def_cfa_offset 8
 587              		.cfi_offset 14, -4
 588              		.cfi_offset 3, -8
 250:../src/drv/drv_gps.c ****     while (!gpsAvailable()); // wait for some bytes
 589              		.loc 1 250 0
 590 03fa 00BF     		nop
 591              	.L15:
 592              		.loc 1 250 0 is_stmt 0 discriminator 1
 593 03fc FFF7FEFF 		bl	gpsAvailable
 594 0400 0346     		mov	r3, r0
 595 0402 002B     		cmp	r3, #0
 596 0404 FAD0     		beq	.L15
 251:../src/drv/drv_gps.c ****     return gpsRead();
 597              		.loc 1 251 0 is_stmt 1
 598 0406 FFF7FEFF 		bl	gpsRead
 599 040a 0346     		mov	r3, r0
 252:../src/drv/drv_gps.c **** }
 600              		.loc 1 252 0
 601 040c 1846     		mov	r0, r3
 602 040e 08BD     		pop	{r3, pc}
 603              		.cfi_endproc
 604              	.LFE118:
 606              		.align	2
 607              		.global	gpsWrite
 608              		.thumb
 609              		.thumb_func
 611              	gpsWrite:
 612              	.LFB119:
 253:../src/drv/drv_gps.c **** 
 254:../src/drv/drv_gps.c **** ///////////////////////////////////////////////////////////////////////////////
 255:../src/drv/drv_gps.c **** // GPS Write
 256:../src/drv/drv_gps.c **** ///////////////////////////////////////////////////////////////////////////////
 257:../src/drv/drv_gps.c **** 
 258:../src/drv/drv_gps.c **** void gpsWrite(uint8_t ch)
 259:../src/drv/drv_gps.c **** {
 613              		.loc 1 259 0
 614              		.cfi_startproc
 615              		@ args = 0, pretend = 0, frame = 8
 616              		@ frame_needed = 0, uses_anonymous_args = 0
 617 0410 00B5     		push	{lr}
 618              	.LCFI10:
 619              		.cfi_def_cfa_offset 4
 620              		.cfi_offset 14, -4
 621 0412 83B0     		sub	sp, sp, #12
 622              	.LCFI11:
 623              		.cfi_def_cfa_offset 16
 624 0414 0346     		mov	r3, r0
 625 0416 8DF80730 		strb	r3, [sp, #7]
 260:../src/drv/drv_gps.c ****     tx2Buffer[tx2BufferHead] = ch;
 626              		.loc 1 260 0
 627 041a 40F20003 		movw	r3, #:lower16:tx2BufferHead
 628 041e C0F20003 		movt	r3, #:upper16:tx2BufferHead
 629 0422 1B88     		ldrh	r3, [r3, #0]
 630 0424 1A46     		mov	r2, r3
 631 0426 40F20003 		movw	r3, #:lower16:tx2Buffer
 632 042a C0F20003 		movt	r3, #:upper16:tx2Buffer
 633 042e 9DF80710 		ldrb	r1, [sp, #7]
 634 0432 9954     		strb	r1, [r3, r2]
 261:../src/drv/drv_gps.c ****     tx2BufferHead = (tx2BufferHead + 1) % UART2_BUFFER_SIZE;
 635              		.loc 1 261 0
 636 0434 40F20003 		movw	r3, #:lower16:tx2BufferHead
 637 0438 C0F20003 		movt	r3, #:upper16:tx2BufferHead
 638 043c 1B88     		ldrh	r3, [r3, #0]
 639 043e 03F10103 		add	r3, r3, #1
 640 0442 4FEAE372 		asr	r2, r3, #31
 641 0446 4FEA5252 		lsr	r2, r2, #21
 642 044a 9B18     		adds	r3, r3, r2
 643 044c 4FEA4353 		lsl	r3, r3, #21
 644 0450 4FEA5353 		lsr	r3, r3, #21
 645 0454 9B1A     		subs	r3, r3, r2
 646 0456 9AB2     		uxth	r2, r3
 647 0458 40F20003 		movw	r3, #:lower16:tx2BufferHead
 648 045c C0F20003 		movt	r3, #:upper16:tx2BufferHead
 649 0460 1A80     		strh	r2, [r3, #0]	@ movhi
 262:../src/drv/drv_gps.c **** 
 263:../src/drv/drv_gps.c ****     // if DMA wasn't enabled, fire it up
 264:../src/drv/drv_gps.c ****     if (!(DMA1_Channel7->CCR & 1))
 650              		.loc 1 264 0
 651 0462 4FF08003 		mov	r3, #128
 652 0466 C4F20203 		movt	r3, 16386
 653 046a 1B68     		ldr	r3, [r3, #0]
 654 046c 03F00103 		and	r3, r3, #1
 655 0470 002B     		cmp	r3, #0
 656 0472 01D1     		bne	.L16
 265:../src/drv/drv_gps.c ****         uart2TxDMA();
 657              		.loc 1 265 0
 658 0474 FFF7C4FD 		bl	uart2TxDMA
 659              	.L16:
 266:../src/drv/drv_gps.c **** }
 660              		.loc 1 266 0
 661 0478 03B0     		add	sp, sp, #12
 662 047a 00BD     		pop	{pc}
 663              		.cfi_endproc
 664              	.LFE119:
 666              		.align	2
 667              		.global	gpsPrint
 668              		.thumb
 669              		.thumb_func
 671              	gpsPrint:
 672              	.LFB120:
 267:../src/drv/drv_gps.c **** 
 268:../src/drv/drv_gps.c **** ///////////////////////////////////////////////////////////////////////////////
 269:../src/drv/drv_gps.c **** // GPS Print
 270:../src/drv/drv_gps.c **** ///////////////////////////////////////////////////////////////////////////////
 271:../src/drv/drv_gps.c **** 
 272:../src/drv/drv_gps.c **** void gpsPrint(char *str)
 273:../src/drv/drv_gps.c **** {
 673              		.loc 1 273 0
 674              		.cfi_startproc
 675              		@ args = 0, pretend = 0, frame = 8
 676              		@ frame_needed = 0, uses_anonymous_args = 0
 677 047c 00B5     		push	{lr}
 678              	.LCFI12:
 679              		.cfi_def_cfa_offset 4
 680              		.cfi_offset 14, -4
 681 047e 83B0     		sub	sp, sp, #12
 682              	.LCFI13:
 683              		.cfi_def_cfa_offset 16
 684 0480 0190     		str	r0, [sp, #4]
 274:../src/drv/drv_gps.c ****     while (*str)
 685              		.loc 1 274 0
 686 0482 08E0     		b	.L19
 687              	.L20:
 275:../src/drv/drv_gps.c **** 	    gpsWrite(*(str++));
 688              		.loc 1 275 0
 689 0484 019B     		ldr	r3, [sp, #4]
 690 0486 1B78     		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 691 0488 019A     		ldr	r2, [sp, #4]
 692 048a 02F10102 		add	r2, r2, #1
 693 048e 0192     		str	r2, [sp, #4]
 694 0490 1846     		mov	r0, r3
 695 0492 FFF7FEFF 		bl	gpsWrite
 696              	.L19:
 274:../src/drv/drv_gps.c ****     while (*str)
 697              		.loc 1 274 0 discriminator 1
 698 0496 019B     		ldr	r3, [sp, #4]
 699 0498 1B78     		ldrb	r3, [r3, #0]	@ zero_extendqisi2
 700 049a 002B     		cmp	r3, #0
 701 049c F2D1     		bne	.L20
 276:../src/drv/drv_gps.c **** }
 702              		.loc 1 276 0
 703 049e 03B0     		add	sp, sp, #12
 704 04a0 00BD     		pop	{pc}
 705              		.cfi_endproc
 706              	.LFE120:
 708              	.Letext0:
 709              		.file 2 "c:\\program files\\codesourcery\\sourcery_codebench_lite_for_arm_eabi\\bin\\../lib/gcc/ar
 710              		.file 3 "D:\\Documents and Settings\\e722209\\Desktop\\workspace\\aq32Plus_F3\\Libraries\\Device\\
 711              		.file 4 "D:\\Documents and Settings\\e722209\\Desktop\\workspace\\aq32Plus_F3\\Libraries\\STM32F30
 712              		.file 5 "D:\\Documents and Settings\\e722209\\Desktop\\workspace\\aq32Plus_F3\\Libraries\\STM32F30
 713              		.file 6 "D:\\Documents and Settings\\e722209\\Desktop\\workspace\\aq32Plus_F3\\Libraries\\STM32F30
 714              		.file 7 "D:\\Documents and Settings\\e722209\\Desktop\\workspace\\aq32Plus_F3\\Libraries\\STM32F30
 715              		.file 8 "D:\\Documents and Settings\\e722209\\Desktop\\workspace\\aq32Plus_F3\\src\\gps/gpsMediaTe
 716              		.file 9 "D:\\Documents and Settings\\e722209\\Desktop\\workspace\\aq32Plus_F3\\src\\gps/gpsNMEA.h"
 717              		.file 10 "D:\\Documents and Settings\\e722209\\Desktop\\workspace\\aq32Plus_F3\\src\\gps/gpsUblox.
 718              		.file 11 "D:\\Documents and Settings\\e722209\\Desktop\\workspace\\aq32Plus_F3\\Libraries\\CMSIS\\
DEFINED SYMBOLS
                            *ABS*:00000000 drv_gps.c
                            *COM*:00000001 mtk19ProcessDataState
                            *COM*:00000001 nmeaProcessDataState
                            *COM*:00000001 ubloxProcessDataState
                            *COM*:00000800 rx2Buffer
D:\DOCUME~1\e722209\LOCALS~1\Temp\cc2iys1H.s:28     .bss:00000000 rx2DMAPos
D:\DOCUME~1\e722209\LOCALS~1\Temp\cc2iys1H.s:25     .bss:00000000 $d
                            *COM*:00000800 tx2Buffer
D:\DOCUME~1\e722209\LOCALS~1\Temp\cc2iys1H.s:35     .bss:00000004 tx2BufferTail
D:\DOCUME~1\e722209\LOCALS~1\Temp\cc2iys1H.s:41     .bss:00000006 tx2BufferHead
D:\DOCUME~1\e722209\LOCALS~1\Temp\cc2iys1H.s:44     .text:00000000 $t
D:\DOCUME~1\e722209\LOCALS~1\Temp\cc2iys1H.s:48     .text:00000000 uart2TxDMA
D:\DOCUME~1\e722209\LOCALS~1\Temp\cc2iys1H.s:130    .text:000000ac DMA1_Channel7_IRQHandler
D:\DOCUME~1\e722209\LOCALS~1\Temp\cc2iys1H.s:171    .text:000000e4 gpsInit
D:\DOCUME~1\e722209\LOCALS~1\Temp\cc2iys1H.s:409    .text:00000314 gpsAvailable
D:\DOCUME~1\e722209\LOCALS~1\Temp\cc2iys1H.s:445    .text:00000340 gpsClearBuffer
D:\DOCUME~1\e722209\LOCALS~1\Temp\cc2iys1H.s:475    .text:00000360 gpsNumCharsAvailable
D:\DOCUME~1\e722209\LOCALS~1\Temp\cc2iys1H.s:526    .text:0000039c gpsRead
D:\DOCUME~1\e722209\LOCALS~1\Temp\cc2iys1H.s:578    .text:000003f8 gpsReadPoll
D:\DOCUME~1\e722209\LOCALS~1\Temp\cc2iys1H.s:611    .text:00000410 gpsWrite
D:\DOCUME~1\e722209\LOCALS~1\Temp\cc2iys1H.s:671    .text:0000047c gpsPrint
                     .debug_frame:00000010 $d

UNDEFINED SYMBOLS
DMA_Cmd
DMA_ClearITPendingBit
RCC_AHBPeriphClockCmd
RCC_APB1PeriphClockCmd
GPIO_PinAFConfig
GPIO_Init
NVIC_Init
USART_Init
DMA_DeInit
DMA_Init
USART_DMACmd
DMA_GetCurrDataCounter
DMA_ITConfig
USART_Cmd
