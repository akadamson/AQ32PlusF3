   1              		.syntax unified
   2              		.cpu cortex-m4
   3              		.eabi_attribute 27, 3
   4              		.fpu fpv4-sp-d16
   5              		.eabi_attribute 20, 1
   6              		.eabi_attribute 21, 1
   7              		.eabi_attribute 23, 3
   8              		.eabi_attribute 24, 1
   9              		.eabi_attribute 25, 1
  10              		.eabi_attribute 26, 1
  11              		.eabi_attribute 30, 6
  12              		.eabi_attribute 34, 1
  13              		.eabi_attribute 18, 4
  14              		.thumb
  15              		.file	"vertCompFilter.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.comm	mtk19ProcessDataState,1,1
  20              		.comm	nmeaProcessDataState,1,1
  21              		.comm	ubloxProcessDataState,1,1
  22              		.comm	accelZ,4,4
  23              		.global	estimationError
  24              		.bss
  25              		.align	2
  28              	estimationError:
  29 0000 00000000 		.space	4
  30              		.global	hDotEstimate
  31              		.align	2
  34              	hDotEstimate:
  35 0004 00000000 		.space	4
  36              		.comm	hEstimate,4,4
  37              		.global	previousExecUp
  40              	previousExecUp:
  41 0008 00       		.space	1
  42 0009 000000   		.text
  43              		.align	2
  44              		.global	vertCompFilter
  45              		.thumb
  46              		.thumb_func
  48              	vertCompFilter:
  49              	.LFB111:
  50              		.file 1 "../src/vertCompFilter.c"
   1:../src/vertCompFilter.c **** /*
   2:../src/vertCompFilter.c ****  December 2012
   3:../src/vertCompFilter.c **** 
   4:../src/vertCompFilter.c ****   aq32Plus_F3 Rev -
   5:../src/vertCompFilter.c **** 
   6:../src/vertCompFilter.c ****   Copyright (c) 2012 John Ihlein.  All rights reserved.
   7:../src/vertCompFilter.c **** 
   8:../src/vertCompFilter.c ****   Open Source STM32 Based Multicopter Controller Software
   9:../src/vertCompFilter.c **** 
  10:../src/vertCompFilter.c ****   Includes code and/or ideas from:
  11:../src/vertCompFilter.c **** 
  12:../src/vertCompFilter.c ****   1)AeroQuad
  13:../src/vertCompFilter.c ****   2)BaseFlight
  14:../src/vertCompFilter.c ****   3)CH Robotics
  15:../src/vertCompFilter.c ****   4)MultiWii
  16:../src/vertCompFilter.c ****   5)S.O.H. Madgwick
  17:../src/vertCompFilter.c ****   6)UAVX
  18:../src/vertCompFilter.c ****   7)STM DiscoveryF3 demonstration software
  19:../src/vertCompFilter.c **** 
  20:../src/vertCompFilter.c ****   Designed to run on the DiscoveryF3 board
  21:../src/vertCompFilter.c **** 
  22:../src/vertCompFilter.c ****   This program is free software: you can redistribute it and/or modify
  23:../src/vertCompFilter.c ****   it under the terms of the GNU General Public License as published by
  24:../src/vertCompFilter.c ****   the Free Software Foundation, either version 3 of the License, or
  25:../src/vertCompFilter.c ****   (at your option) any later version.
  26:../src/vertCompFilter.c **** 
  27:../src/vertCompFilter.c ****   This program is distributed in the hope that it will be useful,
  28:../src/vertCompFilter.c ****   but WITHOUT ANY WARRANTY; without even the implied warranty of
  29:../src/vertCompFilter.c ****   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
  30:../src/vertCompFilter.c ****   GNU General Public License for more details.
  31:../src/vertCompFilter.c **** 
  32:../src/vertCompFilter.c ****   You should have received a copy of the GNU General Public License
  33:../src/vertCompFilter.c ****   along with this program. If not, see <http://www.gnu.org/licenses/>.
  34:../src/vertCompFilter.c **** */
  35:../src/vertCompFilter.c **** 
  36:../src/vertCompFilter.c **** ///////////////////////////////////////////////////////////////////////////////
  37:../src/vertCompFilter.c **** 
  38:../src/vertCompFilter.c **** #include "board.h"
  39:../src/vertCompFilter.c **** 
  40:../src/vertCompFilter.c **** ///////////////////////////////////////////////////////////////////////////////
  41:../src/vertCompFilter.c **** // Vertical Complementary Filter Defines and Variables
  42:../src/vertCompFilter.c **** ///////////////////////////////////////////////////////////////////////////////
  43:../src/vertCompFilter.c **** 
  44:../src/vertCompFilter.c **** float   accelZ;
  45:../src/vertCompFilter.c **** float   estimationError = 0.0f;
  46:../src/vertCompFilter.c **** float   hDotEstimate    = 0.0f;
  47:../src/vertCompFilter.c **** float   hEstimate;
  48:../src/vertCompFilter.c **** uint8_t previousExecUp  = false;
  49:../src/vertCompFilter.c **** 
  50:../src/vertCompFilter.c **** ///////////////////////////////////////////////////////////////////////////////
  51:../src/vertCompFilter.c **** // Vertical Complementary Filter
  52:../src/vertCompFilter.c **** ///////////////////////////////////////////////////////////////////////////////
  53:../src/vertCompFilter.c **** 
  54:../src/vertCompFilter.c **** void vertCompFilter(float dt)
  55:../src/vertCompFilter.c **** {
  51              		.loc 1 55 0
  52              		.cfi_startproc
  53              		@ args = 0, pretend = 0, frame = 8
  54              		@ frame_needed = 0, uses_anonymous_args = 0
  55              		@ link register save eliminated.
  56 0000 82B0     		sub	sp, sp, #8
  57              	.LCFI0:
  58              		.cfi_def_cfa_offset 8
  59 0002 0190     		str	r0, [sp, #4]	@ float
  56:../src/vertCompFilter.c ****     if ((execUp == true) && (previousExecUp == false))
  60              		.loc 1 56 0
  61 0004 40F20003 		movw	r3, #:lower16:execUp
  62 0008 C0F20003 		movt	r3, #:upper16:execUp
  63 000c 1B78     		ldrb	r3, [r3, #0]	@ zero_extendqisi2
  64 000e 012B     		cmp	r3, #1
  65 0010 10D1     		bne	.L2
  66              		.loc 1 56 0 is_stmt 0 discriminator 1
  67 0012 40F20003 		movw	r3, #:lower16:previousExecUp
  68 0016 C0F20003 		movt	r3, #:upper16:previousExecUp
  69 001a 1B78     		ldrb	r3, [r3, #0]	@ zero_extendqisi2
  70 001c 002B     		cmp	r3, #0
  71 001e 09D1     		bne	.L2
  57:../src/vertCompFilter.c ****     	hEstimate = sensors.pressureAlt10Hz;
  72              		.loc 1 57 0 is_stmt 1
  73 0020 40F20003 		movw	r3, #:lower16:sensors
  74 0024 C0F20003 		movt	r3, #:upper16:sensors
  75 0028 DA6B     		ldr	r2, [r3, #60]	@ float
  76 002a 40F20003 		movw	r3, #:lower16:hEstimate
  77 002e C0F20003 		movt	r3, #:upper16:hEstimate
  78 0032 1A60     		str	r2, [r3, #0]	@ float
  79              	.L2:
  58:../src/vertCompFilter.c **** 
  59:../src/vertCompFilter.c ****     previousExecUp = execUp;
  80              		.loc 1 59 0
  81 0034 40F20003 		movw	r3, #:lower16:execUp
  82 0038 C0F20003 		movt	r3, #:upper16:execUp
  83 003c 1A78     		ldrb	r2, [r3, #0]	@ zero_extendqisi2
  84 003e 40F20003 		movw	r3, #:lower16:previousExecUp
  85 0042 C0F20003 		movt	r3, #:upper16:previousExecUp
  86 0046 1A70     		strb	r2, [r3, #0]
  60:../src/vertCompFilter.c **** 
  61:../src/vertCompFilter.c **** 	if (execUp == true)
  87              		.loc 1 61 0
  88 0048 40F20003 		movw	r3, #:lower16:execUp
  89 004c C0F20003 		movt	r3, #:upper16:execUp
  90 0050 1B78     		ldrb	r3, [r3, #0]	@ zero_extendqisi2
  91 0052 012B     		cmp	r3, #1
  92 0054 6FD1     		bne	.L1
  62:../src/vertCompFilter.c ****     {
  63:../src/vertCompFilter.c ****     	accelZ = -earthAxisAccels[ZAXIS] + eepromConfig.compFilterB * estimationError;
  93              		.loc 1 63 0
  94 0056 40F20003 		movw	r3, #:lower16:eepromConfig
  95 005a C0F20003 		movt	r3, #:upper16:eepromConfig
  96 005e 93ED167A 		flds	s14, [r3, #88]
  97 0062 40F20003 		movw	r3, #:lower16:estimationError
  98 0066 C0F20003 		movt	r3, #:upper16:estimationError
  99 006a D3ED007A 		flds	s15, [r3, #0]
 100 006e 67EE277A 		fmuls	s15, s14, s15
 101 0072 40F20003 		movw	r3, #:lower16:earthAxisAccels
 102 0076 C0F20003 		movt	r3, #:upper16:earthAxisAccels
 103 007a 93ED027A 		flds	s14, [r3, #8]
 104 007e 77EEC77A 		fsubs	s15, s15, s14
 105 0082 40F20003 		movw	r3, #:lower16:accelZ
 106 0086 C0F20003 		movt	r3, #:upper16:accelZ
 107 008a C3ED007A 		fsts	s15, [r3, #0]
  64:../src/vertCompFilter.c **** 
  65:../src/vertCompFilter.c ****         hDotEstimate += accelZ * dt;
 108              		.loc 1 65 0
 109 008e 40F20003 		movw	r3, #:lower16:accelZ
 110 0092 C0F20003 		movt	r3, #:upper16:accelZ
 111 0096 93ED007A 		flds	s14, [r3, #0]
 112 009a DDED017A 		flds	s15, [sp, #4]
 113 009e 67EE277A 		fmuls	s15, s14, s15
 114 00a2 40F20003 		movw	r3, #:lower16:hDotEstimate
 115 00a6 C0F20003 		movt	r3, #:upper16:hDotEstimate
 116 00aa 93ED007A 		flds	s14, [r3, #0]
 117 00ae 77EE877A 		fadds	s15, s15, s14
 118 00b2 40F20003 		movw	r3, #:lower16:hDotEstimate
 119 00b6 C0F20003 		movt	r3, #:upper16:hDotEstimate
 120 00ba C3ED007A 		fsts	s15, [r3, #0]
  66:../src/vertCompFilter.c **** 
  67:../src/vertCompFilter.c ****         hEstimate += (hDotEstimate + eepromConfig.compFilterA * estimationError) * dt;
 121              		.loc 1 67 0
 122 00be 40F20003 		movw	r3, #:lower16:eepromConfig
 123 00c2 C0F20003 		movt	r3, #:upper16:eepromConfig
 124 00c6 93ED157A 		flds	s14, [r3, #84]
 125 00ca 40F20003 		movw	r3, #:lower16:estimationError
 126 00ce C0F20003 		movt	r3, #:upper16:estimationError
 127 00d2 D3ED007A 		flds	s15, [r3, #0]
 128 00d6 67EE277A 		fmuls	s15, s14, s15
 129 00da 40F20003 		movw	r3, #:lower16:hDotEstimate
 130 00de C0F20003 		movt	r3, #:upper16:hDotEstimate
 131 00e2 93ED007A 		flds	s14, [r3, #0]
 132 00e6 37EE877A 		fadds	s14, s15, s14
 133 00ea DDED017A 		flds	s15, [sp, #4]
 134 00ee 67EE277A 		fmuls	s15, s14, s15
 135 00f2 40F20003 		movw	r3, #:lower16:hEstimate
 136 00f6 C0F20003 		movt	r3, #:upper16:hEstimate
 137 00fa 93ED007A 		flds	s14, [r3, #0]
 138 00fe 77EE877A 		fadds	s15, s15, s14
 139 0102 40F20003 		movw	r3, #:lower16:hEstimate
 140 0106 C0F20003 		movt	r3, #:upper16:hEstimate
 141 010a C3ED007A 		fsts	s15, [r3, #0]
  68:../src/vertCompFilter.c **** 
  69:../src/vertCompFilter.c ****         estimationError = sensors.pressureAlt10Hz - hEstimate;
 142              		.loc 1 69 0
 143 010e 40F20003 		movw	r3, #:lower16:sensors
 144 0112 C0F20003 		movt	r3, #:upper16:sensors
 145 0116 93ED0F7A 		flds	s14, [r3, #60]
 146 011a 40F20003 		movw	r3, #:lower16:hEstimate
 147 011e C0F20003 		movt	r3, #:upper16:hEstimate
 148 0122 D3ED007A 		flds	s15, [r3, #0]
 149 0126 77EE677A 		fsubs	s15, s14, s15
 150 012a 40F20003 		movw	r3, #:lower16:estimationError
 151 012e C0F20003 		movt	r3, #:upper16:estimationError
 152 0132 C3ED007A 		fsts	s15, [r3, #0]
 153              	.L1:
  70:../src/vertCompFilter.c ****     }
  71:../src/vertCompFilter.c **** }
 154              		.loc 1 71 0
 155 0136 02B0     		add	sp, sp, #8
 156 0138 7047     		bx	lr
 157              		.cfi_endproc
 158              	.LFE111:
 160              	.Letext0:
 161              		.file 2 "c:\\program files\\codesourcery\\sourcery_codebench_lite_for_arm_eabi\\bin\\../lib/gcc/ar
 162              		.file 3 "../src/pid.h"
 163              		.file 4 "../src/aq32Plus_F3.h"
 164              		.file 5 "D:\\Documents and Settings\\e722209\\Desktop\\workspace\\aq32Plus_F3\\src\\gps/gpsMediaTe
 165              		.file 6 "D:\\Documents and Settings\\e722209\\Desktop\\workspace\\aq32Plus_F3\\src\\gps/gpsNMEA.h"
 166              		.file 7 "D:\\Documents and Settings\\e722209\\Desktop\\workspace\\aq32Plus_F3\\src\\gps/gpsUblox.h
 167              		.file 8 "D:\\Documents and Settings\\e722209\\Desktop\\workspace\\aq32Plus_F3\\Libraries\\CMSIS\\I
 168              		.file 9 "D:\\Documents and Settings\\e722209\\Desktop\\workspace\\aq32Plus_F3\\src\\drv/drv_system
 169              		.file 10 "../src/coordinateTransforms.h"
DEFINED SYMBOLS
                            *ABS*:00000000 vertCompFilter.c
                            *COM*:00000001 mtk19ProcessDataState
                            *COM*:00000001 nmeaProcessDataState
                            *COM*:00000001 ubloxProcessDataState
                            *COM*:00000004 accelZ
D:\DOCUME~1\e722209\LOCALS~1\Temp\cc8lTCab.s:28     .bss:00000000 estimationError
D:\DOCUME~1\e722209\LOCALS~1\Temp\cc8lTCab.s:25     .bss:00000000 $d
D:\DOCUME~1\e722209\LOCALS~1\Temp\cc8lTCab.s:34     .bss:00000004 hDotEstimate
                            *COM*:00000004 hEstimate
D:\DOCUME~1\e722209\LOCALS~1\Temp\cc8lTCab.s:40     .bss:00000008 previousExecUp
D:\DOCUME~1\e722209\LOCALS~1\Temp\cc8lTCab.s:43     .text:00000000 $t
D:\DOCUME~1\e722209\LOCALS~1\Temp\cc8lTCab.s:48     .text:00000000 vertCompFilter
                     .debug_frame:00000010 $d

UNDEFINED SYMBOLS
execUp
sensors
eepromConfig
earthAxisAccels
