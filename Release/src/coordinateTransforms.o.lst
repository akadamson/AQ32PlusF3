   1              		.syntax unified
   2              		.cpu cortex-m4
   3              		.eabi_attribute 27, 3
   4              		.fpu fpv4-sp-d16
   5              		.eabi_attribute 20, 1
   6              		.eabi_attribute 21, 1
   7              		.eabi_attribute 23, 3
   8              		.eabi_attribute 24, 1
   9              		.eabi_attribute 25, 1
  10              		.eabi_attribute 26, 1
  11              		.eabi_attribute 30, 6
  12              		.eabi_attribute 34, 1
  13              		.eabi_attribute 18, 4
  14              		.thumb
  15              		.file	"coordinateTransforms.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.comm	mtk19ProcessDataState,1,1
  20              		.comm	nmeaProcessDataState,1,1
  21              		.comm	ubloxProcessDataState,1,1
  22              		.global	earthAxisAccels
  23              		.bss
  24              		.align	2
  27              	earthAxisAccels:
  28 0000 00000000 		.space	12
  28      00000000 
  28      00000000 
  29              		.comm	rotationMatrix,36,4
  30              		.text
  31              		.align	2
  32              		.global	createRotationMatrix
  33              		.thumb
  34              		.thumb_func
  36              	createRotationMatrix:
  37              	.LFB111:
  38              		.file 1 "../src/coordinateTransforms.c"
   1:../src/coordinateTransforms.c **** /*
   2:../src/coordinateTransforms.c ****   December 2012
   3:../src/coordinateTransforms.c **** 
   4:../src/coordinateTransforms.c ****   aq32Plus_F3 Rev -
   5:../src/coordinateTransforms.c **** 
   6:../src/coordinateTransforms.c ****   Copyright (c) 2012 John Ihlein.  All rights reserved.
   7:../src/coordinateTransforms.c **** 
   8:../src/coordinateTransforms.c ****   Open Source STM32 Based Multicopter Controller Software
   9:../src/coordinateTransforms.c **** 
  10:../src/coordinateTransforms.c ****   Includes code and/or ideas from:
  11:../src/coordinateTransforms.c **** 
  12:../src/coordinateTransforms.c ****   1)AeroQuad
  13:../src/coordinateTransforms.c ****   2)BaseFlight
  14:../src/coordinateTransforms.c ****   3)CH Robotics
  15:../src/coordinateTransforms.c ****   4)MultiWii
  16:../src/coordinateTransforms.c ****   5)S.O.H. Madgwick
  17:../src/coordinateTransforms.c ****   6)UAVX
  18:../src/coordinateTransforms.c ****   7)STM DiscoveryF3 demonstration software
  19:../src/coordinateTransforms.c **** 
  20:../src/coordinateTransforms.c ****   Designed to run on the DiscoveryF3 board
  21:../src/coordinateTransforms.c **** 
  22:../src/coordinateTransforms.c ****   This program is free software: you can redistribute it and/or modify
  23:../src/coordinateTransforms.c ****   it under the terms of the GNU General Public License as published by
  24:../src/coordinateTransforms.c ****   the Free Software Foundation, either version 3 of the License, or
  25:../src/coordinateTransforms.c ****   (at your option) any later version.
  26:../src/coordinateTransforms.c **** 
  27:../src/coordinateTransforms.c ****   This program is distributed in the hope that it will be useful,
  28:../src/coordinateTransforms.c ****   but WITHOUT ANY WARRANTY; without even the implied warranty of
  29:../src/coordinateTransforms.c ****   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
  30:../src/coordinateTransforms.c ****   GNU General Public License for more details.
  31:../src/coordinateTransforms.c **** 
  32:../src/coordinateTransforms.c ****   You should have received a copy of the GNU General Public License
  33:../src/coordinateTransforms.c ****   along with this program. If not, see <http://www.gnu.org/licenses/>.
  34:../src/coordinateTransforms.c **** */
  35:../src/coordinateTransforms.c **** 
  36:../src/coordinateTransforms.c **** ///////////////////////////////////////////////////////////////////////////////
  37:../src/coordinateTransforms.c **** 
  38:../src/coordinateTransforms.c **** #include "board.h"
  39:../src/coordinateTransforms.c **** 
  40:../src/coordinateTransforms.c **** ///////////////////////////////////////////////////////////////////////////////
  41:../src/coordinateTransforms.c **** // Coordinate Transformation Defines and Variables
  42:../src/coordinateTransforms.c **** ///////////////////////////////////////////////////////////////////////////////
  43:../src/coordinateTransforms.c **** 
  44:../src/coordinateTransforms.c **** float earthAxisAccels[3] = { 0.0f, 0.0f, 0.0f };
  45:../src/coordinateTransforms.c **** 
  46:../src/coordinateTransforms.c **** float rotationMatrix[9];
  47:../src/coordinateTransforms.c **** 
  48:../src/coordinateTransforms.c **** ///////////////////////////////////////////////////////////////////////////////
  49:../src/coordinateTransforms.c **** // Create Rotation Matrix
  50:../src/coordinateTransforms.c **** ///////////////////////////////////////////////////////////////////////////////
  51:../src/coordinateTransforms.c **** 
  52:../src/coordinateTransforms.c **** void createRotationMatrix(void)
  53:../src/coordinateTransforms.c **** {
  39              		.loc 1 53 0
  40              		.cfi_startproc
  41              		@ args = 0, pretend = 0, frame = 0
  42              		@ frame_needed = 0, uses_anonymous_args = 0
  43              		@ link register save eliminated.
  54:../src/coordinateTransforms.c ****     rotationMatrix[0] = q0q0 +q1q1 - q2q2 - q3q3;
  44              		.loc 1 54 0
  45 0000 40F20003 		movw	r3, #:lower16:q0q0
  46 0004 C0F20003 		movt	r3, #:upper16:q0q0
  47 0008 93ED007A 		flds	s14, [r3, #0]
  48 000c 40F20003 		movw	r3, #:lower16:q1q1
  49 0010 C0F20003 		movt	r3, #:upper16:q1q1
  50 0014 D3ED007A 		flds	s15, [r3, #0]
  51 0018 37EE277A 		fadds	s14, s14, s15
  52 001c 40F20003 		movw	r3, #:lower16:q2q2
  53 0020 C0F20003 		movt	r3, #:upper16:q2q2
  54 0024 D3ED007A 		flds	s15, [r3, #0]
  55 0028 37EE677A 		fsubs	s14, s14, s15
  56 002c 40F20003 		movw	r3, #:lower16:q3q3
  57 0030 C0F20003 		movt	r3, #:upper16:q3q3
  58 0034 D3ED007A 		flds	s15, [r3, #0]
  59 0038 77EE677A 		fsubs	s15, s14, s15
  60 003c 40F20003 		movw	r3, #:lower16:rotationMatrix
  61 0040 C0F20003 		movt	r3, #:upper16:rotationMatrix
  62 0044 C3ED007A 		fsts	s15, [r3, #0]
  55:../src/coordinateTransforms.c **** 
  56:../src/coordinateTransforms.c ****     rotationMatrix[1] = 2.0f * (q1q2 - q0q3);
  63              		.loc 1 56 0
  64 0048 40F20003 		movw	r3, #:lower16:q1q2
  65 004c C0F20003 		movt	r3, #:upper16:q1q2
  66 0050 93ED007A 		flds	s14, [r3, #0]
  67 0054 40F20003 		movw	r3, #:lower16:q0q3
  68 0058 C0F20003 		movt	r3, #:upper16:q0q3
  69 005c D3ED007A 		flds	s15, [r3, #0]
  70 0060 77EE677A 		fsubs	s15, s14, s15
  71 0064 77EEA77A 		fadds	s15, s15, s15
  72 0068 40F20003 		movw	r3, #:lower16:rotationMatrix
  73 006c C0F20003 		movt	r3, #:upper16:rotationMatrix
  74 0070 C3ED017A 		fsts	s15, [r3, #4]
  57:../src/coordinateTransforms.c **** 
  58:../src/coordinateTransforms.c ****     rotationMatrix[2] = 2.0f * (q0q2 + q1q3);
  75              		.loc 1 58 0
  76 0074 40F20003 		movw	r3, #:lower16:q0q2
  77 0078 C0F20003 		movt	r3, #:upper16:q0q2
  78 007c 93ED007A 		flds	s14, [r3, #0]
  79 0080 40F20003 		movw	r3, #:lower16:q1q3
  80 0084 C0F20003 		movt	r3, #:upper16:q1q3
  81 0088 D3ED007A 		flds	s15, [r3, #0]
  82 008c 77EE277A 		fadds	s15, s14, s15
  83 0090 77EEA77A 		fadds	s15, s15, s15
  84 0094 40F20003 		movw	r3, #:lower16:rotationMatrix
  85 0098 C0F20003 		movt	r3, #:upper16:rotationMatrix
  86 009c C3ED027A 		fsts	s15, [r3, #8]
  59:../src/coordinateTransforms.c **** 
  60:../src/coordinateTransforms.c ****     rotationMatrix[3] = 2.0f * (q1q2 + q0q3);
  87              		.loc 1 60 0
  88 00a0 40F20003 		movw	r3, #:lower16:q1q2
  89 00a4 C0F20003 		movt	r3, #:upper16:q1q2
  90 00a8 93ED007A 		flds	s14, [r3, #0]
  91 00ac 40F20003 		movw	r3, #:lower16:q0q3
  92 00b0 C0F20003 		movt	r3, #:upper16:q0q3
  93 00b4 D3ED007A 		flds	s15, [r3, #0]
  94 00b8 77EE277A 		fadds	s15, s14, s15
  95 00bc 77EEA77A 		fadds	s15, s15, s15
  96 00c0 40F20003 		movw	r3, #:lower16:rotationMatrix
  97 00c4 C0F20003 		movt	r3, #:upper16:rotationMatrix
  98 00c8 C3ED037A 		fsts	s15, [r3, #12]
  61:../src/coordinateTransforms.c **** 
  62:../src/coordinateTransforms.c ****     rotationMatrix[4] = q0q0 - q1q1 + q2q2 - q3q3;
  99              		.loc 1 62 0
 100 00cc 40F20003 		movw	r3, #:lower16:q0q0
 101 00d0 C0F20003 		movt	r3, #:upper16:q0q0
 102 00d4 93ED007A 		flds	s14, [r3, #0]
 103 00d8 40F20003 		movw	r3, #:lower16:q1q1
 104 00dc C0F20003 		movt	r3, #:upper16:q1q1
 105 00e0 D3ED007A 		flds	s15, [r3, #0]
 106 00e4 37EE677A 		fsubs	s14, s14, s15
 107 00e8 40F20003 		movw	r3, #:lower16:q2q2
 108 00ec C0F20003 		movt	r3, #:upper16:q2q2
 109 00f0 D3ED007A 		flds	s15, [r3, #0]
 110 00f4 37EE277A 		fadds	s14, s14, s15
 111 00f8 40F20003 		movw	r3, #:lower16:q3q3
 112 00fc C0F20003 		movt	r3, #:upper16:q3q3
 113 0100 D3ED007A 		flds	s15, [r3, #0]
 114 0104 77EE677A 		fsubs	s15, s14, s15
 115 0108 40F20003 		movw	r3, #:lower16:rotationMatrix
 116 010c C0F20003 		movt	r3, #:upper16:rotationMatrix
 117 0110 C3ED047A 		fsts	s15, [r3, #16]
  63:../src/coordinateTransforms.c **** 
  64:../src/coordinateTransforms.c ****     rotationMatrix[5] = 2.0f * (q2q3 - q0q1);
 118              		.loc 1 64 0
 119 0114 40F20003 		movw	r3, #:lower16:q2q3
 120 0118 C0F20003 		movt	r3, #:upper16:q2q3
 121 011c 93ED007A 		flds	s14, [r3, #0]
 122 0120 40F20003 		movw	r3, #:lower16:q0q1
 123 0124 C0F20003 		movt	r3, #:upper16:q0q1
 124 0128 D3ED007A 		flds	s15, [r3, #0]
 125 012c 77EE677A 		fsubs	s15, s14, s15
 126 0130 77EEA77A 		fadds	s15, s15, s15
 127 0134 40F20003 		movw	r3, #:lower16:rotationMatrix
 128 0138 C0F20003 		movt	r3, #:upper16:rotationMatrix
 129 013c C3ED057A 		fsts	s15, [r3, #20]
  65:../src/coordinateTransforms.c **** 
  66:../src/coordinateTransforms.c ****     rotationMatrix[6] = 2.0f * (q1q3 - q0q2);
 130              		.loc 1 66 0
 131 0140 40F20003 		movw	r3, #:lower16:q1q3
 132 0144 C0F20003 		movt	r3, #:upper16:q1q3
 133 0148 93ED007A 		flds	s14, [r3, #0]
 134 014c 40F20003 		movw	r3, #:lower16:q0q2
 135 0150 C0F20003 		movt	r3, #:upper16:q0q2
 136 0154 D3ED007A 		flds	s15, [r3, #0]
 137 0158 77EE677A 		fsubs	s15, s14, s15
 138 015c 77EEA77A 		fadds	s15, s15, s15
 139 0160 40F20003 		movw	r3, #:lower16:rotationMatrix
 140 0164 C0F20003 		movt	r3, #:upper16:rotationMatrix
 141 0168 C3ED067A 		fsts	s15, [r3, #24]
  67:../src/coordinateTransforms.c **** 
  68:../src/coordinateTransforms.c ****     rotationMatrix[7] = 2.0f * (q0q1 + q2q3);
 142              		.loc 1 68 0
 143 016c 40F20003 		movw	r3, #:lower16:q0q1
 144 0170 C0F20003 		movt	r3, #:upper16:q0q1
 145 0174 93ED007A 		flds	s14, [r3, #0]
 146 0178 40F20003 		movw	r3, #:lower16:q2q3
 147 017c C0F20003 		movt	r3, #:upper16:q2q3
 148 0180 D3ED007A 		flds	s15, [r3, #0]
 149 0184 77EE277A 		fadds	s15, s14, s15
 150 0188 77EEA77A 		fadds	s15, s15, s15
 151 018c 40F20003 		movw	r3, #:lower16:rotationMatrix
 152 0190 C0F20003 		movt	r3, #:upper16:rotationMatrix
 153 0194 C3ED077A 		fsts	s15, [r3, #28]
  69:../src/coordinateTransforms.c **** 
  70:../src/coordinateTransforms.c ****     rotationMatrix[8] = q0q0 - q1q1 - q2q2 + q3q3;
 154              		.loc 1 70 0
 155 0198 40F20003 		movw	r3, #:lower16:q0q0
 156 019c C0F20003 		movt	r3, #:upper16:q0q0
 157 01a0 93ED007A 		flds	s14, [r3, #0]
 158 01a4 40F20003 		movw	r3, #:lower16:q1q1
 159 01a8 C0F20003 		movt	r3, #:upper16:q1q1
 160 01ac D3ED007A 		flds	s15, [r3, #0]
 161 01b0 37EE677A 		fsubs	s14, s14, s15
 162 01b4 40F20003 		movw	r3, #:lower16:q2q2
 163 01b8 C0F20003 		movt	r3, #:upper16:q2q2
 164 01bc D3ED007A 		flds	s15, [r3, #0]
 165 01c0 37EE677A 		fsubs	s14, s14, s15
 166 01c4 40F20003 		movw	r3, #:lower16:q3q3
 167 01c8 C0F20003 		movt	r3, #:upper16:q3q3
 168 01cc D3ED007A 		flds	s15, [r3, #0]
 169 01d0 77EE277A 		fadds	s15, s14, s15
 170 01d4 40F20003 		movw	r3, #:lower16:rotationMatrix
 171 01d8 C0F20003 		movt	r3, #:upper16:rotationMatrix
 172 01dc C3ED087A 		fsts	s15, [r3, #32]
  71:../src/coordinateTransforms.c **** }
 173              		.loc 1 71 0
 174 01e0 7047     		bx	lr
 175              		.cfi_endproc
 176              	.LFE111:
 178 01e2 00BF     		.align	2
 179              		.global	bodyAccelToEarthAccel
 180              		.thumb
 181              		.thumb_func
 183              	bodyAccelToEarthAccel:
 184              	.LFB112:
  72:../src/coordinateTransforms.c **** 
  73:../src/coordinateTransforms.c **** ///////////////////////////////////////////////////////////////////////////////
  74:../src/coordinateTransforms.c **** // Rotate Body Accels to Earth Accels
  75:../src/coordinateTransforms.c **** ///////////////////////////////////////////////////////////////////////////////
  76:../src/coordinateTransforms.c **** 
  77:../src/coordinateTransforms.c **** void bodyAccelToEarthAccel(void)
  78:../src/coordinateTransforms.c **** {
 185              		.loc 1 78 0
 186              		.cfi_startproc
 187              		@ args = 0, pretend = 0, frame = 0
 188              		@ frame_needed = 0, uses_anonymous_args = 0
 189 01e4 00B5     		push	{lr}
 190              	.LCFI0:
 191              		.cfi_def_cfa_offset 4
 192              		.cfi_offset 14, -4
 193 01e6 83B0     		sub	sp, sp, #12
 194              	.LCFI1:
 195              		.cfi_def_cfa_offset 16
  79:../src/coordinateTransforms.c ****     matrixMultiply(3, 3, 1, earthAxisAccels, rotationMatrix, sensors.accel100Hz);
 196              		.loc 1 79 0
 197 01e8 40F20003 		movw	r3, #:lower16:rotationMatrix
 198 01ec C0F20003 		movt	r3, #:upper16:rotationMatrix
 199 01f0 0093     		str	r3, [sp, #0]
 200 01f2 124B     		ldr	r3, .L3
 201 01f4 0193     		str	r3, [sp, #4]
 202 01f6 4FF00300 		mov	r0, #3
 203 01fa 4FF00301 		mov	r1, #3
 204 01fe 4FF00102 		mov	r2, #1
 205 0202 40F20003 		movw	r3, #:lower16:earthAxisAccels
 206 0206 C0F20003 		movt	r3, #:upper16:earthAxisAccels
 207 020a FFF7FEFF 		bl	matrixMultiply
  80:../src/coordinateTransforms.c **** 
  81:../src/coordinateTransforms.c ****     earthAxisAccels[ZAXIS] += accelOneG;
 208              		.loc 1 81 0
 209 020e 40F20003 		movw	r3, #:lower16:earthAxisAccels
 210 0212 C0F20003 		movt	r3, #:upper16:earthAxisAccels
 211 0216 93ED027A 		flds	s14, [r3, #8]
 212 021a 40F20003 		movw	r3, #:lower16:accelOneG
 213 021e C0F20003 		movt	r3, #:upper16:accelOneG
 214 0222 D3ED007A 		flds	s15, [r3, #0]
 215 0226 77EE277A 		fadds	s15, s14, s15
 216 022a 40F20003 		movw	r3, #:lower16:earthAxisAccels
 217 022e C0F20003 		movt	r3, #:upper16:earthAxisAccels
 218 0232 C3ED027A 		fsts	s15, [r3, #8]
  82:../src/coordinateTransforms.c **** }
 219              		.loc 1 82 0
 220 0236 03B0     		add	sp, sp, #12
 221 0238 00BD     		pop	{pc}
 222              	.L4:
 223 023a 00BF     		.align	2
 224              	.L3:
 225 023c 0C000000 		.word	sensors+12
 226              		.cfi_endproc
 227              	.LFE112:
 229              	.Letext0:
 230              		.file 2 "c:\\program files\\codesourcery\\sourcery_codebench_lite_for_arm_eabi\\bin\\../lib/gcc/ar
 231              		.file 3 "../src/aq32Plus_F3.h"
 232              		.file 4 "D:\\Documents and Settings\\e722209\\Desktop\\workspace\\aq32Plus_F3\\src\\gps/gpsMediaTe
 233              		.file 5 "D:\\Documents and Settings\\e722209\\Desktop\\workspace\\aq32Plus_F3\\src\\gps/gpsNMEA.h"
 234              		.file 6 "D:\\Documents and Settings\\e722209\\Desktop\\workspace\\aq32Plus_F3\\src\\gps/gpsUblox.h
 235              		.file 7 "D:\\Documents and Settings\\e722209\\Desktop\\workspace\\aq32Plus_F3\\Libraries\\CMSIS\\I
 236              		.file 8 "D:\\Documents and Settings\\e722209\\Desktop\\workspace\\aq32Plus_F3\\src\\sensors/lsm303
 237              		.file 9 "../src/MargAHRS.h"
DEFINED SYMBOLS
                            *ABS*:00000000 coordinateTransforms.c
                            *COM*:00000001 mtk19ProcessDataState
                            *COM*:00000001 nmeaProcessDataState
                            *COM*:00000001 ubloxProcessDataState
D:\DOCUME~1\e722209\LOCALS~1\Temp\ccuWfoYi.s:27     .bss:00000000 earthAxisAccels
D:\DOCUME~1\e722209\LOCALS~1\Temp\ccuWfoYi.s:24     .bss:00000000 $d
                            *COM*:00000024 rotationMatrix
D:\DOCUME~1\e722209\LOCALS~1\Temp\ccuWfoYi.s:31     .text:00000000 $t
D:\DOCUME~1\e722209\LOCALS~1\Temp\ccuWfoYi.s:36     .text:00000000 createRotationMatrix
D:\DOCUME~1\e722209\LOCALS~1\Temp\ccuWfoYi.s:183    .text:000001e4 bodyAccelToEarthAccel
D:\DOCUME~1\e722209\LOCALS~1\Temp\ccuWfoYi.s:225    .text:0000023c $d
                     .debug_frame:00000010 $d

UNDEFINED SYMBOLS
q0q0
q1q1
q2q2
q3q3
q1q2
q0q3
q0q2
q1q3
q2q3
q0q1
matrixMultiply
accelOneG
sensors
